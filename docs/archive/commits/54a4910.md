#  improve auth error logging and add diagnostic tools (#47)

**Commit:** `54a4910a5cfb987b5f8c8e5c17c6c41a0f3f4683`
**Date:** 2025-12-07
**Auteur:** Tallec7
**Type:** fix

## Description

* fix(sync-agent): improve auth error logging and add diagnostic tools
- Add detailed logging for authentication attempts on central server
- Include specific error messages (site not found, invalid API key)
- Add diagnose.js script to test connection and auth from Raspberry
- Add resync-apikey.js to regenerate and sync API key with server
- Improve sync-agent startup logs with API key length info
- Fix TypeScript type errors in sites.controller.ts and socket.service.ts
ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
Co-Authored-By: Claude <noreply@anthropic.com>
* docs(sync-agent): add diagnostic and resync scripts documentation
- Document npm run diagnose for troubleshooting connection issues
- Document npm run resync for API key resynchronization
- Add detailed troubleshooting table for auth errors
- Update project structure with new scripts
- Update date to December 2025
ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
Co-Authored-By: Claude <noreply@anthropic.com>
* fix(sync-agent): handle permission denied in register-site.js
Display config content when /etc/neopro/site.conf cannot be written
due to missing permissions, allowing manual copy or sudo rerun.
ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
Co-Authored-By: Claude <noreply@anthropic.com>
* fix(setup): fix sync-agent configuration in setup-new-club.sh
- Use correct central server URL (neopro-central.onrender.com)
- Fix service name (neopro-sync-agent instead of neopro-sync)
- Fix shell variable expansion in SSH heredoc
- Use CLUB_FULL_NAME for club_name (not the uppercase identifier)
- Add diagnose command to useful commands summary
- Update manual setup instructions to use npm run register
ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
Co-Authored-By: Claude <noreply@anthropic.com>
---------
Co-authored-by: Claude <noreply@anthropic.com>

## Fichiers modifi√©s

```
raspberry/scripts/setup-new-club.sh
raspberry/sync-agent/scripts/register-site.js
```

---
[‚Üê Retour au changelog](../CHANGELOG.md)

