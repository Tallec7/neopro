<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neopro Admin - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <img src="neopro-logo-white.png" alt="Neopro" height="40">
                <span style="margin-left: 12px; font-family: var(--neo-font-body); font-size: 20px; font-weight: 600;">Admin</span>
            </div>
            <div class="header-info">
                <span id="hostname">Loading...</span>
                <span id="current-time">--:--:--</span>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav">
            <button class="nav-btn active" data-tab="dashboard">
                üìä Dashboard
            </button>
            <button class="nav-btn" data-tab="videos">
                üé¨ Vid√©os
            </button>
            <button class="nav-btn" data-tab="network">
                üì° R√©seau
            </button>
            <button class="nav-btn" data-tab="logs">
                üìú Logs
            </button>
            <button class="nav-btn" data-tab="system">
                ‚öôÔ∏è Syst√®me
            </button>
        </nav>

        <!-- Content -->
        <main class="content">

            <!-- Tab: Dashboard -->
            <div id="tab-dashboard" class="tab-content active">
                <h2>√âtat du syst√®me</h2>

                <div class="cards-grid">
                    <!-- CPU Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üíª CPU</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric">
                                <span class="metric-label">Utilisation</span>
                                <span class="metric-value" id="cpu-usage">--</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Coeurs</span>
                                <span class="metric-value" id="cpu-cores">--</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="cpu-progress"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Memory Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üß† M√©moire</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric">
                                <span class="metric-label">Utilis√©e</span>
                                <span class="metric-value" id="mem-used">--</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Total</span>
                                <span class="metric-value" id="mem-total">--</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="mem-progress"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Temperature Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üå°Ô∏è Temp√©rature</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-large" id="temperature">--</div>
                        </div>
                    </div>

                    <!-- Disk Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üíæ Stockage</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric">
                                <span class="metric-label">Utilis√©</span>
                                <span class="metric-value" id="disk-used">--</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Total</span>
                                <span class="metric-value" id="disk-total">--</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="disk-progress"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Services Status -->
                <div class="card">
                    <div class="card-header">
                        <h3>üîß Services</h3>
                    </div>
                    <div class="card-body">
                        <div class="services-grid" id="services-grid">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Uptime -->
                <div class="info-box">
                    <span>‚è±Ô∏è Uptime: <strong id="uptime">--</strong></span>
                </div>
            </div>

            <!-- Tab: Videos -->
            <div id="tab-videos" class="tab-content">
                <h2>Gestion des vid√©os</h2>

                <!-- Sub-navigation for videos tab -->
                <div class="videos-subnav">
                    <button class="subnav-btn active" data-subtab="library">üìÅ Biblioth√®que</button>
                    <button class="subnav-btn" data-subtab="upload">üì§ Ajouter</button>
                    <button class="subnav-btn" data-subtab="organize">üìÇ Organiser</button>
                    <button class="subnav-btn" data-subtab="remote">‚è±Ô∏è T√©l√©commande</button>
                </div>

                <!-- Subtab: Library (default) -->
                <div id="subtab-library" class="subtab-content active">
                    <div class="card">
                        <div class="card-header">
                            <h3>üìÅ Biblioth√®que vid√©os</h3>
                            <button class="btn btn-secondary" onclick="refreshVideos()">üîÑ Actualiser</button>
                        </div>
                        <div class="card-body">
                            <div class="search-bar">
                                <input type="text" id="video-search" class="search-input" placeholder="üîç Rechercher une vid√©o..." oninput="filterVideos()">
                            </div>
                            <div class="videos-list" id="videos-list">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subtab: Upload -->
                <div id="subtab-upload" class="subtab-content">
                    <div class="card">
                        <div class="card-header">
                            <h3>üì§ Ajouter des vid√©os</h3>
                        </div>
                        <div class="card-body">
                            <form id="upload-form" enctype="multipart/form-data">
                                <div class="form-group">
                                    <label for="video-file">Fichiers vid√©o (MP4, MKV, MOV - max 500MB par fichier)</label>
                                    <div id="drop-zone" class="drop-zone">
                                        <div class="drop-zone-content">
                                            <span class="drop-zone-icon">üìÅ</span>
                                            <p>Glissez-d√©posez vos vid√©os ici</p>
                                            <p class="drop-zone-hint">ou cliquez pour s√©lectionner</p>
                                        </div>
                                        <input type="file" id="video-file" name="videos" accept="video/*" multiple>
                                    </div>
                                    <div id="selected-files" class="selected-files" style="display: none;">
                                        <div class="selected-files-header">
                                            <span id="files-count">0 fichier(s) s√©lectionn√©(s)</span>
                                            <button type="button" class="btn btn-small btn-secondary" onclick="clearSelectedFiles()">Effacer</button>
                                        </div>
                                        <ul id="files-list" class="files-list"></ul>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="video-category">Cat√©gorie</label>
                                        <select id="video-category" name="category" required>
                                            <option value="">-- Chargement... --</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="subcategory-group" style="display: none;">
                                        <label for="video-subcategory">Sous-cat√©gorie</label>
                                        <select id="video-subcategory" name="subcategory">
                                            <option value="">-- Aucune --</option>
                                        </select>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary" id="upload-btn">
                                    üì§ Upload
                                </button>
                            </form>
                            <div id="upload-progress" class="upload-progress" style="display: none;">
                                <div class="progress-info">
                                    <span id="upload-current-file"></span>
                                    <span id="upload-file-count"></span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="upload-progress-bar"></div>
                                </div>
                                <span id="upload-status">Uploading...</span>
                                <div id="upload-results" class="upload-results" style="display: none;">
                                    <ul id="upload-results-list"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subtab: Organize (Categories) -->
                <div id="subtab-organize" class="subtab-content">
                    <div class="card">
                        <div class="card-header">
                            <h3>üìÇ Cat√©gories et sous-cat√©gories</h3>
                            <button class="btn btn-secondary" onclick="refreshCategories()">üîÑ Actualiser</button>
                        </div>
                        <div class="card-body">
                            <p class="info-text">
                                Cr√©ez et organisez vos cat√©gories et sous-cat√©gories de vid√©os.
                            </p>
                            <div id="categories-manager" class="categories-manager">
                                <!-- Populated by JS -->
                            </div>
                            <button class="btn btn-primary" onclick="addCategory()" style="margin-top: 16px;">
                                ‚ûï Nouvelle cat√©gorie
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Subtab: Remote (Time Categories) -->
                <div id="subtab-remote" class="subtab-content">
                    <div class="card">
                        <div class="card-header">
                            <h3>‚è±Ô∏è Organisation par temps</h3>
                            <button class="btn btn-secondary" onclick="refreshTimeCategories()">üîÑ Actualiser</button>
                        </div>
                        <div class="card-body">
                            <p class="info-text">
                                Configurez les blocs temps de la t√©l√©commande (Avant-match, Match, Apr√®s-match) et associez-y vos cat√©gories.
                            </p>
                            <div id="time-categories-list" class="time-categories-list">
                                <!-- Populated by JS -->
                            </div>
                            <button class="btn btn-primary" onclick="addTimeCategory()" style="margin-top: 16px;">
                                ‚ûï Ajouter un bloc temps
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Network -->
            <div id="tab-network" class="tab-content">
                <h2>Configuration r√©seau</h2>

                <!-- WiFi Client Config -->
                <div class="card">
                    <div class="card-header">
                        <h3>üì° WiFi Client (Acc√®s distant)</h3>
                    </div>
                    <div class="card-body">
                        <p class="info-text">
                            Configurez le Raspberry Pi pour se connecter au WiFi local du club.
                            Cela permet l'acc√®s SSH distant pour les mises √† jour.
                        </p>
                        <form id="wifi-form">
                            <div class="form-group">
                                <label for="wifi-ssid">SSID du WiFi</label>
                                <input type="text" id="wifi-ssid" name="ssid" required>
                            </div>
                            <div class="form-group">
                                <label for="wifi-password">Mot de passe</label>
                                <input type="password" id="wifi-password" name="password" required>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                üíæ Configurer
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Network Info -->
                <div class="card">
                    <div class="card-header">
                        <h3>üåê Informations r√©seau</h3>
                        <button class="btn btn-secondary" onclick="refreshNetwork()">üîÑ Actualiser</button>
                    </div>
                    <div class="card-body">
                        <div id="network-info">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Logs -->
            <div id="tab-logs" class="tab-content">
                <h2>Logs syst√®me</h2>

                <div class="card">
                    <div class="card-header">
                        <h3>üìú Logs</h3>
                        <div class="btn-group">
                            <button class="btn btn-sm active" data-log="app">Application</button>
                            <button class="btn btn-sm" data-log="nginx">Nginx</button>
                            <button class="btn btn-sm" data-log="system">Syst√®me</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="logs-container">
                            <pre id="logs-content">Chargement des logs...</pre>
                        </div>
                        <button class="btn btn-secondary" onclick="refreshLogs()">üîÑ Actualiser</button>
                    </div>
                </div>
            </div>

            <!-- Tab: System -->
            <div id="tab-system" class="tab-content">
                <h2>Administration syst√®me</h2>

                <!-- Services Control -->
                <div class="card">
                    <div class="card-header">
                        <h3>üîß Contr√¥le des services</h3>
                    </div>
                    <div class="card-body">
                        <div class="services-control">
                            <div class="service-control-item">
                                <span>Application Neopro</span>
                                <button class="btn btn-warning" onclick="restartService('neopro-app')">
                                    üîÑ Red√©marrer
                                </button>
                            </div>
                            <div class="service-control-item">
                                <span>Serveur Web (Nginx)</span>
                                <button class="btn btn-warning" onclick="restartService('nginx')">
                                    üîÑ Red√©marrer
                                </button>
                            </div>
                            <div class="service-control-item">
                                <span>Mode Kiosque</span>
                                <button class="btn btn-warning" onclick="restartService('neopro-kiosk')">
                                    üîÑ Red√©marrer
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Update System -->
                <div class="card">
                    <div class="card-header">
                        <h3>üì¶ Mise √† jour</h3>
                    </div>
                    <div class="card-body">
                        <p class="info-text">
                            Uploadez une archive de mise √† jour (.tar.gz) pour mettre √† jour l'application.
                            Un backup automatique sera cr√©√©.
                        </p>
                        <form id="update-form" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="update-file">Archive de mise √† jour (.tar.gz)</label>
                                <input type="file" id="update-file" name="package" accept=".tar.gz" required>
                            </div>
                            <button type="submit" class="btn btn-warning">
                                üì¶ Mettre √† jour
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Power Controls -->
                <div class="card danger-zone">
                    <div class="card-header">
                        <h3>‚ö†Ô∏è Zone dangereuse</h3>
                    </div>
                    <div class="card-body">
                        <div class="power-controls">
                            <button class="btn btn-danger" onclick="confirmAction('reboot')">
                                üîÑ Red√©marrer le syst√®me
                            </button>
                            <button class="btn btn-danger" onclick="confirmAction('shutdown')">
                                üî¥ √âteindre le syst√®me
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- Footer -->
        <footer class="footer">
            <span>Neopro v1.0.0 | Raspberry Pi Admin Panel</span>
            <span id="last-update">Derni√®re mise √† jour: --</span>
        </footer>
    </div>

    <!-- Edit Video Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content modal-content-wide">
            <h3>Modifier la vid√©o</h3>
            <p id="edit-current-path" class="modal-subtitle"></p>
            <form id="edit-video-form">
                <input type="hidden" id="edit-original-path">
                <div class="form-group">
                    <label for="edit-display-name">Nom affich√©</label>
                    <input type="text" id="edit-display-name" placeholder="Nom visible sur la t√©l√©commande">
                    <small class="form-hint">Laissez vide pour utiliser le nom du fichier.</small>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-category">Cat√©gorie</label>
                        <select id="edit-category" required>
                            <option value="">-- S√©lectionner --</option>
                        </select>
                    </div>
                    <div class="form-group" id="edit-subcategory-group">
                        <label for="edit-subcategory">Sous-cat√©gorie</label>
                        <select id="edit-subcategory">
                            <option value="">-- Aucune --</option>
                        </select>
                        <small class="form-hint">Optionnel</small>
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-filename">Nom du fichier</label>
                    <input type="text" id="edit-filename" required>
                    <small class="form-hint">L'extension sera conserv√©e automatiquement.</small>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Annuler</button>
                    <button type="submit" class="btn btn-primary">üíæ Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">Confirmation</h3>
            <p id="modal-message"></p>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal()">Annuler</button>
                <button class="btn btn-danger" id="modal-confirm">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Video Preview Modal -->
    <div id="video-preview-modal" class="modal">
        <div class="modal-content modal-content-video">
            <div class="modal-header">
                <h3 id="preview-video-title">Pr√©visualisation</h3>
                <button class="modal-close-btn" onclick="closeVideoPreview()">‚úï</button>
            </div>
            <div class="video-preview-container">
                <video id="preview-video" controls>
                    Votre navigateur ne supporte pas la lecture vid√©o.
                </video>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
